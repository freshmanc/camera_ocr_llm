# 考试功能与文件上传

## 文件上传（对话框）

- 在语音助手窗口点击 **「上传」**，可选择 **.txt / .pdf / .docx** 文件。
- 文件内容会被读取为文本（PDF/Word 需对应依赖），并在**下一次你发送的消息**中一并发给 LLM。
- 适用场景：上传法语材料后说「翻译」「精讲」「根据文件出题」等；或上传答案文件后说「批改试卷」。

**依赖**（按需安装）：
- PDF：`pip install pdfplumber` 或 `pip install PyPDF2`
- Word：`pip install python-docx`

---

## 考试功能

### 生成试卷

- **触发**：说或输入 **「出卷子」** 或 **「生成试卷」**。
- **材料来源**：优先使用**当前上传的文件内容**，若无则使用**当前摄像头画面识别文字**。
- **输出**：在 `config.EXAM_OUTPUT_DIR`（默认 `logs/exams/`）下生成：
  - 试卷文件：`exam_时间戳_paper.txt`（或 `.pdf` / `.docx`，见配置）
  - 答案文件：`exam_时间戳_answer.txt`（答案单独存放，便于批改时对照）
- **配置**（`config/__init__.py`）：
  - `EXAM_DEFAULT_FORMAT`：`"txt"` | `"pdf"` | `"docx"`
  - `EXAM_NUM_QUESTIONS`：题目数量（默认 5）
  - `EXAM_OUTPUT_DIR`：输出目录

**PDF/Word 依赖**：
- PDF：`pip install fpdf2`
- Word：`pip install python-docx`

未安装时生成会 fallback 为 TXT，并提示安装上述包。

### 批改与讲解

- **触发**：先点击「上传」选择**你的答案文件**（TXT/PDF/Word 均可），然后说或输入 **「批改」** 或 **「批改试卷」**。
- **逻辑**：系统会使用**最近一次生成的试卷**的答案文件进行对照，LLM 批改并给出得分与错题讲解。
- 若从未生成过试卷或答案文件不存在，会提示「请先生成试卷再批改」。

---

## 流程示例

1. **出卷**：上传一份法语课文或对准摄像头 → 说「出卷子」→ 到 `logs/exams/` 查看试卷与答案文件。
2. **作答**：在 TXT 或 Word 中作答后保存。
3. **批改**：点击「上传」选择作答文件 → 说「批改试卷」→ 查看批改结果与讲解。
